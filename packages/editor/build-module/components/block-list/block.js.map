{"version":3,"sources":["/home/circleci/project/packages/editor/src/components/block-list/block.js"],"names":["classnames","get","reduce","size","first","last","Component","Fragment","focus","isTextField","placeCaretAtHorizontalEdge","placeCaretAtVerticalEdge","BACKSPACE","DELETE","ENTER","getBlockType","getSaveElement","isReusableBlock","isUnmodifiedDefaultBlock","getUnregisteredTypeHandlerName","KeyboardShortcuts","withFilters","__","sprintf","withDispatch","withSelect","withViewportMatch","compose","BlockEdit","BlockMover","BlockDropZone","BlockInvalidWarning","BlockCrashWarning","BlockCrashBoundary","BlockHtml","BlockBreadcrumb","BlockContextualToolbar","BlockMultiControls","BlockMobileToolbar","BlockInsertionPoint","IgnoreNestedEvents","InserterWithShortcuts","Inserter","HoverArea","isInsideRootBlock","BlockListBlock","arguments","setBlockListRef","bind","bindBlockNode","setAttributes","maybeHover","forceFocusedContextualToolbar","hideHoverEffects","mergeBlocks","insertBlocksAfter","onFocus","preventDrag","onPointerDown","deleteOrInsertAfterWrapper","onBlockError","onTouchStart","onClick","onDragStart","onDragEnd","selectOnOpen","onShiftSelection","hadTouchStart","state","error","dragging","isHovered","isForcingContextualToolbar","props","isSelected","focusTabbable","prevProps","isTypingWithinBlock","isFirstMultiSelected","wrapperNode","node","blockRef","clientId","forceUpdate","ignoreInnerBlocks","initialPosition","contains","document","activeElement","textInputs","tabbable","find","filter","isReverse","target","attributes","block","onChange","type","name","metaAttributes","result","value","key","meta","onMetaChange","isPartOfMultiSelection","isMultiSelecting","setState","forward","previousBlockClientId","nextBlockClientId","onMerge","blocks","onInsertBlocks","order","onSelect","event","preventDefault","button","shiftKey","onSelectionStart","keyCode","isLocked","onInsertDefaultBlockAfter","onRemove","open","isSelectionEnabled","getBlockSelectionStart","onMultiSelect","hoverArea","mode","isFocusMode","hasFixedToolbar","isFirst","isLast","rootClientId","isCaretWithinFormattedText","isEmptyDefaultBlock","isMovable","isPreviousBlockADefaultEmptyBlock","isParentOfSelectedBlock","isDraggable","className","blockName","isValid","blockType","blockLabel","title","isUnregisteredBlock","showEmptyBlockSideInserter","showSideInserter","shouldAppearSelected","shouldAppearHovered","shouldRenderMovers","shouldShowBreadcrumb","shouldShowContextualToolbar","shouldShowMobileToolbar","shouldShowInsertionPoint","canShowInBetweenInserter","wrapperClassName","onReplace","wrapperProps","getEditWrapperProps","blockElementId","blockEdit","undefined","toggleSelection","display","applyWithSelect","select","isLargeViewport","isBlockSelected","getPreviousBlockClientId","getNextBlockClientId","getBlock","isAncestorMultiSelected","isBlockMultiSelected","isFirstMultiSelectedBlock","isTyping","getBlockIndex","getEditedPostAttribute","getBlockMode","getSelectedBlocksInitialCaretPosition","getEditorSettings","hasSelectedInnerBlock","getTemplateLock","focusMode","previousBlock","templateLock","applyWithDispatch","dispatch","ownProps","updateBlockAttributes","selectBlock","multiSelect","insertBlocks","insertDefaultBlock","removeBlock","replaceBlocks","editPost","index","selectionEnabled"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\nimport { get, reduce, size, first, last } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component, Fragment } from '@wordpress/element';\nimport {\n\tfocus,\n\tisTextField,\n\tplaceCaretAtHorizontalEdge,\n\tplaceCaretAtVerticalEdge,\n} from '@wordpress/dom';\nimport { BACKSPACE, DELETE, ENTER } from '@wordpress/keycodes';\nimport {\n\tgetBlockType,\n\tgetSaveElement,\n\tisReusableBlock,\n\tisUnmodifiedDefaultBlock,\n\tgetUnregisteredTypeHandlerName,\n} from '@wordpress/blocks';\nimport { KeyboardShortcuts, withFilters } from '@wordpress/components';\nimport { __, sprintf } from '@wordpress/i18n';\nimport { withDispatch, withSelect } from '@wordpress/data';\nimport { withViewportMatch } from '@wordpress/viewport';\nimport { compose } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport BlockEdit from '../block-edit';\nimport BlockMover from '../block-mover';\nimport BlockDropZone from '../block-drop-zone';\nimport BlockInvalidWarning from './block-invalid-warning';\nimport BlockCrashWarning from './block-crash-warning';\nimport BlockCrashBoundary from './block-crash-boundary';\nimport BlockHtml from './block-html';\nimport BlockBreadcrumb from './breadcrumb';\nimport BlockContextualToolbar from './block-contextual-toolbar';\nimport BlockMultiControls from './multi-controls';\nimport BlockMobileToolbar from './block-mobile-toolbar';\nimport BlockInsertionPoint from './insertion-point';\nimport IgnoreNestedEvents from '../ignore-nested-events';\nimport InserterWithShortcuts from '../inserter-with-shortcuts';\nimport Inserter from '../inserter';\nimport HoverArea from './hover-area';\nimport { isInsideRootBlock } from '../../utils/dom';\n\nexport class BlockListBlock extends Component {\n\tconstructor() {\n\t\tsuper( ...arguments );\n\n\t\tthis.setBlockListRef = this.setBlockListRef.bind( this );\n\t\tthis.bindBlockNode = this.bindBlockNode.bind( this );\n\t\tthis.setAttributes = this.setAttributes.bind( this );\n\t\tthis.maybeHover = this.maybeHover.bind( this );\n\t\tthis.forceFocusedContextualToolbar = this.forceFocusedContextualToolbar.bind( this );\n\t\tthis.hideHoverEffects = this.hideHoverEffects.bind( this );\n\t\tthis.mergeBlocks = this.mergeBlocks.bind( this );\n\t\tthis.insertBlocksAfter = this.insertBlocksAfter.bind( this );\n\t\tthis.onFocus = this.onFocus.bind( this );\n\t\tthis.preventDrag = this.preventDrag.bind( this );\n\t\tthis.onPointerDown = this.onPointerDown.bind( this );\n\t\tthis.deleteOrInsertAfterWrapper = this.deleteOrInsertAfterWrapper.bind( this );\n\t\tthis.onBlockError = this.onBlockError.bind( this );\n\t\tthis.onTouchStart = this.onTouchStart.bind( this );\n\t\tthis.onClick = this.onClick.bind( this );\n\t\tthis.onDragStart = this.onDragStart.bind( this );\n\t\tthis.onDragEnd = this.onDragEnd.bind( this );\n\t\tthis.selectOnOpen = this.selectOnOpen.bind( this );\n\t\tthis.onShiftSelection = this.onShiftSelection.bind( this );\n\t\tthis.hadTouchStart = false;\n\n\t\tthis.state = {\n\t\t\terror: null,\n\t\t\tdragging: false,\n\t\t\tisHovered: false,\n\t\t};\n\t\tthis.isForcingContextualToolbar = false;\n\t}\n\n\tcomponentDidMount() {\n\t\tif ( this.props.isSelected ) {\n\t\t\tthis.focusTabbable();\n\t\t}\n\t}\n\n\tcomponentDidUpdate( prevProps ) {\n\t\tif ( this.isForcingContextualToolbar ) {\n\t\t\t// The forcing of contextual toolbar should only be true during one update,\n\t\t\t// after the first update normal conditions should apply.\n\t\t\tthis.isForcingContextualToolbar = false;\n\t\t}\n\t\tif ( this.props.isTypingWithinBlock || this.props.isSelected ) {\n\t\t\tthis.hideHoverEffects();\n\t\t}\n\n\t\tif ( this.props.isSelected && ! prevProps.isSelected ) {\n\t\t\tthis.focusTabbable( true );\n\t\t}\n\n\t\t// When triggering a multi-selection,\n\t\t// move the focus to the wrapper of the first selected block.\n\t\tif ( this.props.isFirstMultiSelected && ! prevProps.isFirstMultiSelected ) {\n\t\t\tthis.wrapperNode.focus();\n\t\t}\n\t}\n\n\tsetBlockListRef( node ) {\n\t\tthis.wrapperNode = node;\n\t\tthis.props.blockRef( node, this.props.clientId );\n\n\t\t// We need to rerender to trigger a rerendering of HoverArea\n\t\t// it depents on this.wrapperNode but we can't keep this.wrapperNode in state\n\t\t// Because we need it to be immediately availeble for `focusableTabbable` to work.\n\t\tthis.forceUpdate();\n\t}\n\n\tbindBlockNode( node ) {\n\t\tthis.node = node;\n\t}\n\n\t/**\n\t * When a block becomes selected, transition focus to an inner tabbable.\n\t *\n\t * @param {boolean} ignoreInnerBlocks Should not focus inner blocks.\n\t */\n\tfocusTabbable( ignoreInnerBlocks ) {\n\t\tconst { initialPosition } = this.props;\n\n\t\t// Focus is captured by the wrapper node, so while focus transition\n\t\t// should only consider tabbables within editable display, since it\n\t\t// may be the wrapper itself or a side control which triggered the\n\t\t// focus event, don't unnecessary transition to an inner tabbable.\n\t\tif ( this.wrapperNode.contains( document.activeElement ) ) {\n\t\t\treturn;\n\t\t}\n\n\t\t// Find all tabbables within node.\n\t\tconst textInputs = focus.tabbable\n\t\t\t.find( this.node )\n\t\t\t.filter( isTextField )\n\t\t\t// Exclude inner blocks\n\t\t\t.filter( ( node ) => ! ignoreInnerBlocks || isInsideRootBlock( this.node, node ) );\n\n\t\t// If reversed (e.g. merge via backspace), use the last in the set of\n\t\t// tabbables.\n\t\tconst isReverse = -1 === initialPosition;\n\t\tconst target = ( isReverse ? last : first )( textInputs );\n\n\t\tif ( ! target ) {\n\t\t\tthis.wrapperNode.focus();\n\t\t\treturn;\n\t\t}\n\n\t\ttarget.focus();\n\n\t\t// In reverse case, need to explicitly place caret position.\n\t\tif ( isReverse ) {\n\t\t\tplaceCaretAtHorizontalEdge( target, true );\n\t\t\tplaceCaretAtVerticalEdge( target, true );\n\t\t}\n\t}\n\n\tsetAttributes( attributes ) {\n\t\tconst { block, onChange } = this.props;\n\t\tconst type = getBlockType( block.name );\n\t\tonChange( block.clientId, attributes );\n\n\t\tconst metaAttributes = reduce( attributes, ( result, value, key ) => {\n\t\t\tif ( get( type, [ 'attributes', key, 'source' ] ) === 'meta' ) {\n\t\t\t\tresult[ type.attributes[ key ].meta ] = value;\n\t\t\t}\n\n\t\t\treturn result;\n\t\t}, {} );\n\n\t\tif ( size( metaAttributes ) ) {\n\t\t\tthis.props.onMetaChange( {\n\t\t\t\t...this.props.meta,\n\t\t\t\t...metaAttributes,\n\t\t\t} );\n\t\t}\n\t}\n\n\tonTouchStart() {\n\t\t// Detect touchstart to disable hover on iOS\n\t\tthis.hadTouchStart = true;\n\t}\n\n\tonClick() {\n\t\t// Clear touchstart detection\n\t\t// Browser will try to emulate mouse events also see https://www.html5rocks.com/en/mobile/touchandmouse/\n\t\tthis.hadTouchStart = false;\n\t}\n\n\t/**\n\t * A mouseover event handler to apply hover effect when a pointer device is\n\t * placed within the bounds of the block. The mouseover event is preferred\n\t * over mouseenter because it may be the case that a previous mouseenter\n\t * event was blocked from being handled by a IgnoreNestedEvents component,\n\t * therefore transitioning out of a nested block to the bounds of the block\n\t * would otherwise not trigger a hover effect.\n\t *\n\t * @see https://developer.mozilla.org/en-US/docs/Web/Events/mouseenter\n\t */\n\tmaybeHover() {\n\t\tconst { isPartOfMultiSelection, isSelected } = this.props;\n\t\tconst { isHovered } = this.state;\n\n\t\tif ( isHovered || isPartOfMultiSelection || isSelected ||\n\t\t\t\tthis.props.isMultiSelecting || this.hadTouchStart ) {\n\t\t\treturn;\n\t\t}\n\n\t\tthis.setState( { isHovered: true } );\n\t}\n\n\t/**\n\t * Sets the block state as unhovered if currently hovering. There are cases\n\t * where mouseleave may occur but the block is not hovered (multi-select),\n\t * so to avoid unnecesary renders, the state is only set if hovered.\n\t */\n\thideHoverEffects() {\n\t\tif ( this.state.isHovered ) {\n\t\t\tthis.setState( { isHovered: false } );\n\t\t}\n\t}\n\n\tmergeBlocks( forward = false ) {\n\t\tconst { block, previousBlockClientId, nextBlockClientId, onMerge } = this.props;\n\n\t\t// Do nothing when it's the first block.\n\t\tif (\n\t\t\t( ! forward && ! previousBlockClientId ) ||\n\t\t\t( forward && ! nextBlockClientId )\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( forward ) {\n\t\t\tonMerge( block.clientId, nextBlockClientId );\n\t\t} else {\n\t\t\tonMerge( previousBlockClientId, block.clientId );\n\t\t}\n\t}\n\n\tinsertBlocksAfter( blocks ) {\n\t\tthis.props.onInsertBlocks( blocks, this.props.order + 1 );\n\t}\n\n\t/**\n\t * Marks the block as selected when focused and not already selected. This\n\t * specifically handles the case where block does not set focus on its own\n\t * (via `setFocus`), typically if there is no focusable input in the block.\n\t *\n\t * @return {void}\n\t */\n\tonFocus() {\n\t\tif ( ! this.props.isSelected && ! this.props.isPartOfMultiSelection ) {\n\t\t\tthis.props.onSelect();\n\t\t}\n\t}\n\n\t/**\n\t * Prevents default dragging behavior within a block to allow for multi-\n\t * selection to take effect unhampered.\n\t *\n\t * @param {DragEvent} event Drag event.\n\t *\n\t * @return {void}\n\t */\n\tpreventDrag( event ) {\n\t\tevent.preventDefault();\n\t}\n\n\t/**\n\t * Begins tracking cursor multi-selection when clicking down within block.\n\t *\n\t * @param {MouseEvent} event A mousedown event.\n\t *\n\t * @return {void}\n\t */\n\tonPointerDown( event ) {\n\t\t// Not the main button.\n\t\t// https://developer.mozilla.org/en-US/docs/Web/API/MouseEvent/button\n\t\tif ( event.button !== 0 ) {\n\t\t\treturn;\n\t\t}\n\n\t\tif ( event.shiftKey ) {\n\t\t\tif ( ! this.props.isSelected ) {\n\t\t\t\tthis.onShiftSelection();\n\t\t\t\tevent.preventDefault();\n\t\t\t}\n\t\t} else {\n\t\t\tthis.props.onSelectionStart( this.props.clientId );\n\n\t\t\t// Allow user to escape out of a multi-selection to a singular\n\t\t\t// selection of a block via click. This is handled here since\n\t\t\t// onFocus excludes blocks involved in a multiselection, as\n\t\t\t// focus can be incurred by starting a multiselection (focus\n\t\t\t// moved to first block's multi-controls).\n\t\t\tif ( this.props.isPartOfMultiSelection ) {\n\t\t\t\tthis.props.onSelect();\n\t\t\t}\n\t\t}\n\t}\n\n\t/**\n\t * Interprets keydown event intent to remove or insert after block if key\n\t * event occurs on wrapper node. This can occur when the block has no text\n\t * fields of its own, particularly after initial insertion, to allow for\n\t * easy deletion and continuous writing flow to add additional content.\n\t *\n\t * @param {KeyboardEvent} event Keydown event.\n\t */\n\tdeleteOrInsertAfterWrapper( event ) {\n\t\tconst { keyCode, target } = event;\n\n\t\tif (\n\t\t\t! this.props.isSelected ||\n\t\t\ttarget !== this.wrapperNode ||\n\t\t\tthis.props.isLocked\n\t\t) {\n\t\t\treturn;\n\t\t}\n\n\t\tswitch ( keyCode ) {\n\t\t\tcase ENTER:\n\t\t\t\t// Insert default block after current block if enter and event\n\t\t\t\t// not already handled by descendant.\n\t\t\t\tthis.props.onInsertDefaultBlockAfter();\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\n\t\t\tcase BACKSPACE:\n\t\t\tcase DELETE:\n\t\t\t\t// Remove block on backspace.\n\t\t\t\tconst { clientId, onRemove } = this.props;\n\t\t\t\tonRemove( clientId );\n\t\t\t\tevent.preventDefault();\n\t\t\t\tbreak;\n\t\t}\n\t}\n\n\tonBlockError( error ) {\n\t\tthis.setState( { error } );\n\t}\n\n\tonDragStart() {\n\t\tthis.setState( { dragging: true } );\n\t}\n\n\tonDragEnd() {\n\t\tthis.setState( { dragging: false } );\n\t}\n\n\tselectOnOpen( open ) {\n\t\tif ( open && ! this.props.isSelected ) {\n\t\t\tthis.props.onSelect();\n\t\t}\n\t}\n\n\tonShiftSelection() {\n\t\tif ( ! this.props.isSelectionEnabled ) {\n\t\t\treturn;\n\t\t}\n\n\t\tconst { getBlockSelectionStart, onMultiSelect, onSelect } = this.props;\n\n\t\tif ( getBlockSelectionStart() ) {\n\t\t\tonMultiSelect( getBlockSelectionStart(), this.props.clientId );\n\t\t} else {\n\t\t\tonSelect( this.props.clientId );\n\t\t}\n\t}\n\n\tforceFocusedContextualToolbar() {\n\t\tthis.isForcingContextualToolbar = true;\n\t\t// trigger a re-render\n\t\tthis.setState( () => ( {} ) );\n\t}\n\n\trender() {\n\t\treturn (\n\t\t\t<HoverArea container={ this.wrapperNode }>\n\t\t\t\t{ ( { hoverArea } ) => {\n\t\t\t\t\tconst {\n\t\t\t\t\t\tblock,\n\t\t\t\t\t\torder,\n\t\t\t\t\t\tmode,\n\t\t\t\t\t\tisFocusMode,\n\t\t\t\t\t\thasFixedToolbar,\n\t\t\t\t\t\tisLocked,\n\t\t\t\t\t\tisFirst,\n\t\t\t\t\t\tisLast,\n\t\t\t\t\t\tclientId,\n\t\t\t\t\t\trootClientId,\n\t\t\t\t\t\tisSelected,\n\t\t\t\t\t\tisPartOfMultiSelection,\n\t\t\t\t\t\tisFirstMultiSelected,\n\t\t\t\t\t\tisTypingWithinBlock,\n\t\t\t\t\t\tisCaretWithinFormattedText,\n\t\t\t\t\t\tisMultiSelecting,\n\t\t\t\t\t\tisEmptyDefaultBlock,\n\t\t\t\t\t\tisMovable,\n\t\t\t\t\t\tisPreviousBlockADefaultEmptyBlock,\n\t\t\t\t\t\tisParentOfSelectedBlock,\n\t\t\t\t\t\tisDraggable,\n\t\t\t\t\t\tclassName,\n\t\t\t\t\t} = this.props;\n\t\t\t\t\tconst isHovered = this.state.isHovered && ! isMultiSelecting;\n\t\t\t\t\tconst { name: blockName, isValid } = block;\n\t\t\t\t\tconst blockType = getBlockType( blockName );\n\t\t\t\t\t// translators: %s: Type of block (i.e. Text, Image etc)\n\t\t\t\t\tconst blockLabel = sprintf( __( 'Block: %s' ), blockType.title );\n\t\t\t\t\t// The block as rendered in the editor is composed of general block UI\n\t\t\t\t\t// (mover, toolbar, wrapper) and the display of the block content.\n\n\t\t\t\t\tconst isUnregisteredBlock = block.name === getUnregisteredTypeHandlerName();\n\n\t\t\t\t\t// If the block is selected and we're typing the block should not appear.\n\t\t\t\t\t// Empty paragraph blocks should always show up as unselected.\n\t\t\t\t\tconst showEmptyBlockSideInserter = ( isSelected || isHovered ) && isEmptyDefaultBlock && isValid;\n\t\t\t\t\tconst showSideInserter = ( isSelected || isHovered ) && isEmptyDefaultBlock;\n\t\t\t\t\tconst shouldAppearSelected = ! isFocusMode && ! hasFixedToolbar && ! showSideInserter && isSelected && ! isTypingWithinBlock;\n\t\t\t\t\tconst shouldAppearHovered = ! isFocusMode && ! hasFixedToolbar && isHovered && ! isEmptyDefaultBlock;\n\t\t\t\t\t// We render block movers and block settings to keep them tabbale even if hidden\n\t\t\t\t\tconst shouldRenderMovers = ! isFocusMode && ( isSelected || hoverArea === 'left' ) && ! showEmptyBlockSideInserter && ! isMultiSelecting && ! isPartOfMultiSelection && ! isTypingWithinBlock;\n\t\t\t\t\tconst shouldShowBreadcrumb = ! isFocusMode && isHovered && ! isEmptyDefaultBlock;\n\t\t\t\t\tconst shouldShowContextualToolbar = ! hasFixedToolbar && ! showSideInserter && ( ( isSelected && ( ! isTypingWithinBlock || isCaretWithinFormattedText ) ) || isFirstMultiSelected );\n\t\t\t\t\tconst shouldShowMobileToolbar = shouldAppearSelected;\n\t\t\t\t\tconst { error, dragging } = this.state;\n\n\t\t\t\t\t// Insertion point can only be made visible if the block is at the\n\t\t\t\t\t// the extent of a multi-selection, or not in a multi-selection.\n\t\t\t\t\tconst shouldShowInsertionPoint = ( isPartOfMultiSelection && isFirstMultiSelected ) || ! isPartOfMultiSelection;\n\t\t\t\t\tconst canShowInBetweenInserter = ! isEmptyDefaultBlock && ! isPreviousBlockADefaultEmptyBlock;\n\n\t\t\t\t\t// The wp-block className is important for editor styles.\n\t\t\t\t\t// Generate the wrapper class names handling the different states of the block.\n\t\t\t\t\tconst wrapperClassName = classnames( 'wp-block editor-block-list__block', {\n\t\t\t\t\t\t'has-warning': ! isValid || !! error || isUnregisteredBlock,\n\t\t\t\t\t\t'is-selected': shouldAppearSelected,\n\t\t\t\t\t\t'is-multi-selected': isPartOfMultiSelection,\n\t\t\t\t\t\t'is-hovered': shouldAppearHovered,\n\t\t\t\t\t\t'is-reusable': isReusableBlock( blockType ),\n\t\t\t\t\t\t'is-dragging': dragging,\n\t\t\t\t\t\t'is-typing': isTypingWithinBlock,\n\t\t\t\t\t\t'is-focused': isFocusMode && ( isSelected || isParentOfSelectedBlock ),\n\t\t\t\t\t\t'is-focus-mode': isFocusMode,\n\t\t\t\t\t}, className );\n\n\t\t\t\t\tconst { onReplace } = this.props;\n\n\t\t\t\t\t// Determine whether the block has props to apply to the wrapper.\n\t\t\t\t\tlet wrapperProps = this.props.wrapperProps;\n\t\t\t\t\tif ( blockType.getEditWrapperProps ) {\n\t\t\t\t\t\twrapperProps = {\n\t\t\t\t\t\t\t...wrapperProps,\n\t\t\t\t\t\t\t...blockType.getEditWrapperProps( block.attributes ),\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\tconst blockElementId = `block-${ clientId }`;\n\n\t\t\t\t\t// We wrap the BlockEdit component in a div that hides it when editing in\n\t\t\t\t\t// HTML mode. This allows us to render all of the ancillary pieces\n\t\t\t\t\t// (InspectorControls, etc.) which are inside `BlockEdit` but not\n\t\t\t\t\t// `BlockHTML`, even in HTML mode.\n\t\t\t\t\tlet blockEdit = (\n\t\t\t\t\t\t<BlockEdit\n\t\t\t\t\t\t\tname={ blockName }\n\t\t\t\t\t\t\tisSelected={ isSelected }\n\t\t\t\t\t\t\tattributes={ block.attributes }\n\t\t\t\t\t\t\tsetAttributes={ this.setAttributes }\n\t\t\t\t\t\t\tinsertBlocksAfter={ isLocked ? undefined : this.insertBlocksAfter }\n\t\t\t\t\t\t\tonReplace={ isLocked ? undefined : onReplace }\n\t\t\t\t\t\t\tmergeBlocks={ isLocked ? undefined : this.mergeBlocks }\n\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\tisSelectionEnabled={ this.props.isSelectionEnabled }\n\t\t\t\t\t\t\ttoggleSelection={ this.props.toggleSelection }\n\t\t\t\t\t\t/>\n\t\t\t\t\t);\n\t\t\t\t\tif ( mode !== 'visual' ) {\n\t\t\t\t\t\tblockEdit = <div style={ { display: 'none' } }>{ blockEdit }</div>;\n\t\t\t\t\t}\n\n\t\t\t\t\t// Disable reasons:\n\t\t\t\t\t//\n\t\t\t\t\t//  jsx-a11y/mouse-events-have-key-events:\n\t\t\t\t\t//   - onMouseOver is explicitly handling hover effects\n\t\t\t\t\t//\n\t\t\t\t\t//  jsx-a11y/no-static-element-interactions:\n\t\t\t\t\t//   - Each block can be selected by clicking on it\n\n\t\t\t\t\t/* eslint-disable jsx-a11y/mouse-events-have-key-events, jsx-a11y/no-static-element-interactions, jsx-a11y/onclick-has-role, jsx-a11y/click-events-have-key-events */\n\n\t\t\t\t\treturn (\n\t\t\t\t\t\t<IgnoreNestedEvents\n\t\t\t\t\t\t\tid={ blockElementId }\n\t\t\t\t\t\t\tref={ this.setBlockListRef }\n\t\t\t\t\t\t\tonMouseOver={ this.maybeHover }\n\t\t\t\t\t\t\tonMouseOverHandled={ this.hideHoverEffects }\n\t\t\t\t\t\t\tonMouseLeave={ this.hideHoverEffects }\n\t\t\t\t\t\t\tclassName={ wrapperClassName }\n\t\t\t\t\t\t\tdata-type={ block.name }\n\t\t\t\t\t\t\tonTouchStart={ this.onTouchStart }\n\t\t\t\t\t\t\tonFocus={ this.onFocus }\n\t\t\t\t\t\t\tonClick={ this.onClick }\n\t\t\t\t\t\t\tonKeyDown={ this.deleteOrInsertAfterWrapper }\n\t\t\t\t\t\t\ttabIndex=\"0\"\n\t\t\t\t\t\t\taria-label={ blockLabel }\n\t\t\t\t\t\t\tchildHandledEvents={ [\n\t\t\t\t\t\t\t\t'onDragStart',\n\t\t\t\t\t\t\t\t'onMouseDown',\n\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\t{ ...wrapperProps }\n\t\t\t\t\t\t>\n\t\t\t\t\t\t\t{ shouldShowInsertionPoint && (\n\t\t\t\t\t\t\t\t<BlockInsertionPoint\n\t\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\t\t\tcanShowInserter={ canShowInBetweenInserter }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t<BlockDropZone\n\t\t\t\t\t\t\t\tindex={ order }\n\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t{ shouldRenderMovers && (\n\t\t\t\t\t\t\t\t<BlockMover\n\t\t\t\t\t\t\t\t\tclientIds={ clientId }\n\t\t\t\t\t\t\t\t\tblockElementId={ blockElementId }\n\t\t\t\t\t\t\t\t\tisFirst={ isFirst }\n\t\t\t\t\t\t\t\t\tisLast={ isLast }\n\t\t\t\t\t\t\t\t\tisHidden={ ! ( isHovered || isSelected ) || hoverArea !== 'left' }\n\t\t\t\t\t\t\t\t\tisDraggable={ ( isDraggable !== false ) && ( ! isPartOfMultiSelection && isMovable ) }\n\t\t\t\t\t\t\t\t\tonDragStart={ this.onDragStart }\n\t\t\t\t\t\t\t\t\tonDragEnd={ this.onDragEnd }\n\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t{ isFirstMultiSelected && (\n\t\t\t\t\t\t\t\t<BlockMultiControls rootClientId={ rootClientId } />\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t<div className=\"editor-block-list__block-edit\">\n\t\t\t\t\t\t\t\t{ shouldShowBreadcrumb && (\n\t\t\t\t\t\t\t\t\t<BlockBreadcrumb\n\t\t\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\t\t\tisHidden={ ! ( isHovered || isSelected ) || hoverArea !== 'left' }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t{ (\n\t\t\t\t\t\t\t\t\tshouldShowContextualToolbar ||\n\t\t\t\t\t\t\t\t\tthis.isForcingContextualToolbar\n\t\t\t\t\t\t\t\t) && (\n\t\t\t\t\t\t\t\t\t<BlockContextualToolbar\n\t\t\t\t\t\t\t\t\t\t// If the toolbar is being shown because of being forced\n\t\t\t\t\t\t\t\t\t\t// it should focus the toolbar right after the mount.\n\t\t\t\t\t\t\t\t\t\tfocusOnMount={ this.isForcingContextualToolbar }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t{ (\n\t\t\t\t\t\t\t\t\t! shouldShowContextualToolbar &&\n\t\t\t\t\t\t\t\t\tisSelected &&\n\t\t\t\t\t\t\t\t\t! hasFixedToolbar &&\n\t\t\t\t\t\t\t\t\t! isEmptyDefaultBlock\n\t\t\t\t\t\t\t\t) && (\n\t\t\t\t\t\t\t\t\t<KeyboardShortcuts\n\t\t\t\t\t\t\t\t\t\tbindGlobal\n\t\t\t\t\t\t\t\t\t\teventName=\"keydown\"\n\t\t\t\t\t\t\t\t\t\tshortcuts={ {\n\t\t\t\t\t\t\t\t\t\t\t'alt+f10': this.forceFocusedContextualToolbar,\n\t\t\t\t\t\t\t\t\t\t} }\n\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t<IgnoreNestedEvents\n\t\t\t\t\t\t\t\t\tref={ this.bindBlockNode }\n\t\t\t\t\t\t\t\t\tonDragStart={ this.preventDrag }\n\t\t\t\t\t\t\t\t\tonMouseDown={ this.onPointerDown }\n\t\t\t\t\t\t\t\t\tdata-block={ clientId }\n\t\t\t\t\t\t\t\t>\n\t\t\t\t\t\t\t\t\t<BlockCrashBoundary onError={ this.onBlockError }>\n\t\t\t\t\t\t\t\t\t\t{ isValid && blockEdit }\n\t\t\t\t\t\t\t\t\t\t{ isValid && mode === 'html' && (\n\t\t\t\t\t\t\t\t\t\t\t<BlockHtml clientId={ clientId } />\n\t\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t\t{ ! isValid && [\n\t\t\t\t\t\t\t\t\t\t\t<BlockInvalidWarning\n\t\t\t\t\t\t\t\t\t\t\t\tkey=\"invalid-warning\"\n\t\t\t\t\t\t\t\t\t\t\t\tblock={ block }\n\t\t\t\t\t\t\t\t\t\t\t/>,\n\t\t\t\t\t\t\t\t\t\t\t<div key=\"invalid-preview\">\n\t\t\t\t\t\t\t\t\t\t\t\t{ getSaveElement( blockType, block.attributes ) }\n\t\t\t\t\t\t\t\t\t\t\t</div>,\n\t\t\t\t\t\t\t\t\t\t] }\n\t\t\t\t\t\t\t\t\t</BlockCrashBoundary>\n\t\t\t\t\t\t\t\t\t{ shouldShowMobileToolbar && (\n\t\t\t\t\t\t\t\t\t\t<BlockMobileToolbar\n\t\t\t\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t\t\t\t{ !! error && <BlockCrashWarning /> }\n\t\t\t\t\t\t\t\t</IgnoreNestedEvents>\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t{ showEmptyBlockSideInserter && (\n\t\t\t\t\t\t\t\t<Fragment>\n\t\t\t\t\t\t\t\t\t<div className=\"editor-block-list__side-inserter\">\n\t\t\t\t\t\t\t\t\t\t<InserterWithShortcuts\n\t\t\t\t\t\t\t\t\t\t\tclientId={ clientId }\n\t\t\t\t\t\t\t\t\t\t\trootClientId={ rootClientId }\n\t\t\t\t\t\t\t\t\t\t\tonToggle={ this.selectOnOpen }\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t\t<div className=\"editor-block-list__empty-block-inserter\">\n\t\t\t\t\t\t\t\t\t\t<Inserter\n\t\t\t\t\t\t\t\t\t\t\tposition=\"top right\"\n\t\t\t\t\t\t\t\t\t\t\tonToggle={ this.selectOnOpen }\n\t\t\t\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t\t\t</Fragment>\n\t\t\t\t\t\t\t) }\n\t\t\t\t\t\t</IgnoreNestedEvents>\n\t\t\t\t\t);\n\t\t\t\t\t/* eslint-enable jsx-a11y/no-static-element-interactions, jsx-a11y/onclick-has-role, jsx-a11y/click-events-have-key-events */\n\t\t\t\t} }\n\t\t\t</HoverArea>\n\t\t);\n\t}\n}\n\nconst applyWithSelect = withSelect( ( select, { clientId, rootClientId, isLargeViewport } ) => {\n\tconst {\n\t\tisBlockSelected,\n\t\tgetPreviousBlockClientId,\n\t\tgetNextBlockClientId,\n\t\tgetBlock,\n\t\tisAncestorMultiSelected,\n\t\tisBlockMultiSelected,\n\t\tisFirstMultiSelectedBlock,\n\t\tisMultiSelecting,\n\t\tisTyping,\n\t\tisCaretWithinFormattedText,\n\t\tgetBlockIndex,\n\t\tgetEditedPostAttribute,\n\t\tgetBlockMode,\n\t\tisSelectionEnabled,\n\t\tgetSelectedBlocksInitialCaretPosition,\n\t\tgetEditorSettings,\n\t\thasSelectedInnerBlock,\n\t\tgetTemplateLock,\n\t\tgetBlockSelectionStart,\n\t} = select( 'core/editor' );\n\tconst isSelected = isBlockSelected( clientId );\n\tconst { hasFixedToolbar, focusMode } = getEditorSettings();\n\tconst block = getBlock( clientId );\n\tconst previousBlockClientId = getPreviousBlockClientId( clientId );\n\tconst previousBlock = getBlock( previousBlockClientId );\n\tconst templateLock = getTemplateLock( rootClientId );\n\tconst isParentOfSelectedBlock = hasSelectedInnerBlock( clientId, true );\n\n\treturn {\n\t\tnextBlockClientId: getNextBlockClientId( clientId ),\n\t\tisPartOfMultiSelection: isBlockMultiSelected( clientId ) || isAncestorMultiSelected( clientId ),\n\t\tisFirstMultiSelected: isFirstMultiSelectedBlock( clientId ),\n\t\tisMultiSelecting: isMultiSelecting(),\n\t\t// We only care about this prop when the block is selected\n\t\t// Thus to avoid unnecessary rerenders we avoid updating the prop if the block is not selected.\n\t\tisTypingWithinBlock: ( isSelected || isParentOfSelectedBlock ) && isTyping(),\n\t\tisCaretWithinFormattedText: isCaretWithinFormattedText(),\n\t\torder: getBlockIndex( clientId, rootClientId ),\n\t\tmeta: getEditedPostAttribute( 'meta' ),\n\t\tmode: getBlockMode( clientId ),\n\t\tisSelectionEnabled: isSelectionEnabled(),\n\t\tinitialPosition: getSelectedBlocksInitialCaretPosition(),\n\t\tisEmptyDefaultBlock: block && isUnmodifiedDefaultBlock( block ),\n\t\tisPreviousBlockADefaultEmptyBlock: previousBlock && isUnmodifiedDefaultBlock( previousBlock ),\n\t\tisMovable: 'all' !== templateLock,\n\t\tisLocked: !! templateLock,\n\t\tisFocusMode: focusMode && isLargeViewport,\n\t\thasFixedToolbar: hasFixedToolbar && isLargeViewport,\n\t\tpreviousBlockClientId,\n\t\tblock,\n\t\tisSelected,\n\t\tisParentOfSelectedBlock,\n\t\t// We only care about this value when the shift key is pressed.\n\t\t// We call it dynamically in the event handler to avoid unnecessary re-renders.\n\t\tgetBlockSelectionStart,\n\t};\n} );\n\nconst applyWithDispatch = withDispatch( ( dispatch, ownProps ) => {\n\tconst {\n\t\tupdateBlockAttributes,\n\t\tselectBlock,\n\t\tmultiSelect,\n\t\tinsertBlocks,\n\t\tinsertDefaultBlock,\n\t\tremoveBlock,\n\t\tmergeBlocks,\n\t\treplaceBlocks,\n\t\teditPost,\n\t\ttoggleSelection,\n\t} = dispatch( 'core/editor' );\n\n\treturn {\n\t\tonChange( clientId, attributes ) {\n\t\t\tupdateBlockAttributes( clientId, attributes );\n\t\t},\n\t\tonSelect( clientId = ownProps.clientId, initialPosition ) {\n\t\t\tselectBlock( clientId, initialPosition );\n\t\t},\n\t\tonMultiSelect: multiSelect,\n\t\tonInsertBlocks( blocks, index ) {\n\t\t\tconst { rootClientId } = ownProps;\n\t\t\tinsertBlocks( blocks, index, rootClientId );\n\t\t},\n\t\tonInsertDefaultBlockAfter() {\n\t\t\tconst { order, rootClientId } = ownProps;\n\t\t\tinsertDefaultBlock( {}, rootClientId, order + 1 );\n\t\t},\n\t\tonRemove( clientId ) {\n\t\t\tremoveBlock( clientId );\n\t\t},\n\t\tonMerge( ...args ) {\n\t\t\tmergeBlocks( ...args );\n\t\t},\n\t\tonReplace( blocks ) {\n\t\t\treplaceBlocks( [ ownProps.clientId ], blocks );\n\t\t},\n\t\tonMetaChange( meta ) {\n\t\t\teditPost( { meta } );\n\t\t},\n\t\ttoggleSelection( selectionEnabled ) {\n\t\t\ttoggleSelection( selectionEnabled );\n\t\t},\n\t};\n} );\n\nexport default compose(\n\twithViewportMatch( { isLargeViewport: 'medium' } ),\n\tapplyWithSelect,\n\tapplyWithDispatch,\n\twithFilters( 'editor.BlockListBlock' ),\n)( BlockListBlock );\n"]}