{"version":3,"sources":["/home/circleci/project/packages/block-library/src/image/index.js"],"names":["name","blockAttributes","url","type","source","selector","attribute","alt","default","caption","href","id","align","width","height","linkDestination","linkTarget","imageSchema","img","attributes","classes","schema","figure","require","children","a","figcaption","settings","title","description","icon","category","keywords","transforms","from","isMatch","node","nodeName","querySelector","transform","className","alignMatches","exec","undefined","idMatches","Number","anchorElement","outerHTML","files","length","indexOf","file","block","tag","shortcode","content","replace","named","parseInt","getEditWrapperProps","edit","save","image","RichText","isEmpty","deprecated","extraImageProps","figureStyle","maxWidth"],"mappings":"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","sourcesContent":["/**\n * External dependencies\n */\nimport classnames from 'classnames';\n\n/**\n * WordPress dependencies\n */\nimport { Fragment } from '@wordpress/element';\nimport { __ } from '@wordpress/i18n';\nimport {\n\tcreateBlock,\n\tgetBlockAttributes,\n\tgetPhrasingContentSchema,\n} from '@wordpress/blocks';\nimport { RichText } from '@wordpress/editor';\nimport { createBlobURL } from '@wordpress/blob';\nimport {\n\tPath,\n\tSVG,\n} from '@wordpress/components';\n\n/**\n * Internal dependencies\n */\nimport edit from './edit';\n\nexport const name = 'core/image';\n\nconst blockAttributes = {\n\turl: {\n\t\ttype: 'string',\n\t\tsource: 'attribute',\n\t\tselector: 'img',\n\t\tattribute: 'src',\n\t},\n\talt: {\n\t\ttype: 'string',\n\t\tsource: 'attribute',\n\t\tselector: 'img',\n\t\tattribute: 'alt',\n\t\tdefault: '',\n\t},\n\tcaption: {\n\t\ttype: 'string',\n\t\tsource: 'html',\n\t\tselector: 'figcaption',\n\t},\n\thref: {\n\t\ttype: 'string',\n\t\tsource: 'attribute',\n\t\tselector: 'figure > a',\n\t\tattribute: 'href',\n\t},\n\tid: {\n\t\ttype: 'number',\n\t},\n\talign: {\n\t\ttype: 'string',\n\t},\n\twidth: {\n\t\ttype: 'number',\n\t},\n\theight: {\n\t\ttype: 'number',\n\t},\n\tlinkDestination: {\n\t\ttype: 'string',\n\t\tdefault: 'none',\n\t},\n\tlinkTarget: {\n\t\ttype: 'string',\n\t\tsource: 'attribute',\n\t\tselector: 'figure > a',\n\t\tattribute: 'target',\n\t},\n};\n\nconst imageSchema = {\n\timg: {\n\t\tattributes: [ 'src', 'alt' ],\n\t\tclasses: [ 'alignleft', 'aligncenter', 'alignright', 'alignnone', /^wp-image-\\d+$/ ],\n\t},\n};\n\nconst schema = {\n\tfigure: {\n\t\trequire: [ 'img' ],\n\t\tchildren: {\n\t\t\t...imageSchema,\n\t\t\ta: {\n\t\t\t\tattributes: [ 'href', 'target' ],\n\t\t\t\tchildren: imageSchema,\n\t\t\t},\n\t\t\tfigcaption: {\n\t\t\t\tchildren: getPhrasingContentSchema(),\n\t\t\t},\n\t\t},\n\t},\n};\n\nexport const settings = {\n\ttitle: __( 'Image' ),\n\n\tdescription: __( 'Insert an image to make a visual statement.' ),\n\n\ticon: <SVG viewBox=\"0 0 24 24\" xmlns=\"http://www.w3.org/2000/svg\"><Path d=\"M0,0h24v24H0V0z\" fill=\"none\" /><Path d=\"m19 5v14h-14v-14h14m0-2h-14c-1.1 0-2 0.9-2 2v14c0 1.1 0.9 2 2 2h14c1.1 0 2-0.9 2-2v-14c0-1.1-0.9-2-2-2z\" /><Path d=\"m14.14 11.86l-3 3.87-2.14-2.59-3 3.86h12l-3.86-5.14z\" /></SVG>,\n\n\tcategory: 'common',\n\n\tkeywords: [\n\t\t'img', // \"img\" is not translated as it is intended to reflect the HTML <img> tag.\n\t\t__( 'photo' ),\n\t],\n\n\tattributes: blockAttributes,\n\n\ttransforms: {\n\t\tfrom: [\n\t\t\t{\n\t\t\t\ttype: 'raw',\n\t\t\t\tisMatch: ( node ) => node.nodeName === 'FIGURE' && !! node.querySelector( 'img' ),\n\t\t\t\tschema,\n\t\t\t\ttransform: ( node ) => {\n\t\t\t\t\t// Search both figure and image classes. Alignment could be\n\t\t\t\t\t// set on either. ID is set on the image.\n\t\t\t\t\tconst className = node.className + ' ' + node.querySelector( 'img' ).className;\n\t\t\t\t\tconst alignMatches = /(?:^|\\s)align(left|center|right)(?:$|\\s)/.exec( className );\n\t\t\t\t\tconst align = alignMatches ? alignMatches[ 1 ] : undefined;\n\t\t\t\t\tconst idMatches = /(?:^|\\s)wp-image-(\\d+)(?:$|\\s)/.exec( className );\n\t\t\t\t\tconst id = idMatches ? Number( idMatches[ 1 ] ) : undefined;\n\t\t\t\t\tconst anchorElement = node.querySelector( 'a' );\n\t\t\t\t\tconst linkDestination = anchorElement && anchorElement.href ? 'custom' : undefined;\n\t\t\t\t\tconst href = anchorElement && anchorElement.href ? anchorElement.href : undefined;\n\t\t\t\t\tconst attributes = getBlockAttributes( 'core/image', node.outerHTML, { align, id, linkDestination, href } );\n\t\t\t\t\treturn createBlock( 'core/image', attributes );\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'files',\n\t\t\t\tisMatch( files ) {\n\t\t\t\t\treturn files.length === 1 && files[ 0 ].type.indexOf( 'image/' ) === 0;\n\t\t\t\t},\n\t\t\t\ttransform( files ) {\n\t\t\t\t\tconst file = files[ 0 ];\n\t\t\t\t\t// We don't need to upload the media directly here\n\t\t\t\t\t// It's already done as part of the `componentDidMount`\n\t\t\t\t\t// int the image block\n\t\t\t\t\tconst block = createBlock( 'core/image', {\n\t\t\t\t\t\turl: createBlobURL( file ),\n\t\t\t\t\t} );\n\n\t\t\t\t\treturn block;\n\t\t\t\t},\n\t\t\t},\n\t\t\t{\n\t\t\t\ttype: 'shortcode',\n\t\t\t\ttag: 'caption',\n\t\t\t\tattributes: {\n\t\t\t\t\turl: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tsource: 'attribute',\n\t\t\t\t\t\tattribute: 'src',\n\t\t\t\t\t\tselector: 'img',\n\t\t\t\t\t},\n\t\t\t\t\talt: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tsource: 'attribute',\n\t\t\t\t\t\tattribute: 'alt',\n\t\t\t\t\t\tselector: 'img',\n\t\t\t\t\t},\n\t\t\t\t\tcaption: {\n\t\t\t\t\t\tshortcode: ( attributes, { shortcode } ) => {\n\t\t\t\t\t\t\tconst { content } = shortcode;\n\t\t\t\t\t\t\treturn content.replace( /\\s*<img[^>]*>\\s/, '' );\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\thref: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tsource: 'attribute',\n\t\t\t\t\t\tattribute: 'href',\n\t\t\t\t\t\tselector: 'a',\n\t\t\t\t\t},\n\t\t\t\t\tid: {\n\t\t\t\t\t\ttype: 'number',\n\t\t\t\t\t\tshortcode: ( { named: { id } } ) => {\n\t\t\t\t\t\t\tif ( ! id ) {\n\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t}\n\n\t\t\t\t\t\t\treturn parseInt( id.replace( 'attachment_', '' ), 10 );\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t\talign: {\n\t\t\t\t\t\ttype: 'string',\n\t\t\t\t\t\tshortcode: ( { named: { align = 'alignnone' } } ) => {\n\t\t\t\t\t\t\treturn align.replace( 'align', '' );\n\t\t\t\t\t\t},\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t},\n\t\t],\n\t},\n\n\tgetEditWrapperProps( attributes ) {\n\t\tconst { align, width } = attributes;\n\t\tif ( 'left' === align || 'center' === align || 'right' === align || 'wide' === align || 'full' === align ) {\n\t\t\treturn { 'data-align': align, 'data-resized': !! width };\n\t\t}\n\t},\n\n\tedit,\n\n\tsave( { attributes } ) {\n\t\tconst { url, alt, caption, align, href, width, height, id, linkTarget } = attributes;\n\n\t\tconst classes = classnames( {\n\t\t\t[ `align${ align }` ]: align,\n\t\t\t'is-resized': width || height,\n\t\t} );\n\n\t\tconst image = (\n\t\t\t<img\n\t\t\t\tsrc={ url }\n\t\t\t\talt={ alt }\n\t\t\t\tclassName={ id ? `wp-image-${ id }` : null }\n\t\t\t\twidth={ width }\n\t\t\t\theight={ height }\n\t\t\t/>\n\t\t);\n\n\t\tconst figure = (\n\t\t\t<Fragment>\n\t\t\t\t{ href ? <a href={ href } target={ linkTarget } rel={ linkTarget === '_blank' ? 'noreferrer noopener' : undefined }>{ image }</a> : image }\n\t\t\t\t{ ! RichText.isEmpty( caption ) && <RichText.Content tagName=\"figcaption\" value={ caption } /> }\n\t\t\t</Fragment>\n\t\t);\n\n\t\tif ( 'left' === align || 'right' === align || 'center' === align ) {\n\t\t\treturn (\n\t\t\t\t<div>\n\t\t\t\t\t<figure className={ classes }>\n\t\t\t\t\t\t{ figure }\n\t\t\t\t\t</figure>\n\t\t\t\t</div>\n\t\t\t);\n\t\t}\n\n\t\treturn (\n\t\t\t<figure className={ classes }>\n\t\t\t\t{ figure }\n\t\t\t</figure>\n\t\t);\n\t},\n\n\tdeprecated: [\n\t\t{\n\t\t\tattributes: blockAttributes,\n\t\t\tsave( { attributes } ) {\n\t\t\t\tconst { url, alt, caption, align, href, width, height, id } = attributes;\n\n\t\t\t\tconst classes = classnames( {\n\t\t\t\t\t[ `align${ align }` ]: align,\n\t\t\t\t\t'is-resized': width || height,\n\t\t\t\t} );\n\n\t\t\t\tconst image = (\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc={ url }\n\t\t\t\t\t\talt={ alt }\n\t\t\t\t\t\tclassName={ id ? `wp-image-${ id }` : null }\n\t\t\t\t\t\twidth={ width }\n\t\t\t\t\t\theight={ height }\n\t\t\t\t\t/>\n\t\t\t\t);\n\n\t\t\t\treturn (\n\t\t\t\t\t<figure className={ classes }>\n\t\t\t\t\t\t{ href ? <a href={ href }>{ image }</a> : image }\n\t\t\t\t\t\t{ ! RichText.isEmpty( caption ) && <RichText.Content tagName=\"figcaption\" value={ caption } /> }\n\t\t\t\t\t</figure>\n\t\t\t\t);\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\tattributes: blockAttributes,\n\t\t\tsave( { attributes } ) {\n\t\t\t\tconst { url, alt, caption, align, href, width, height, id } = attributes;\n\n\t\t\t\tconst image = (\n\t\t\t\t\t<img\n\t\t\t\t\t\tsrc={ url }\n\t\t\t\t\t\talt={ alt }\n\t\t\t\t\t\tclassName={ id ? `wp-image-${ id }` : null }\n\t\t\t\t\t\twidth={ width }\n\t\t\t\t\t\theight={ height }\n\t\t\t\t\t/>\n\t\t\t\t);\n\n\t\t\t\treturn (\n\t\t\t\t\t<figure className={ align ? `align${ align }` : null } >\n\t\t\t\t\t\t{ href ? <a href={ href }>{ image }</a> : image }\n\t\t\t\t\t\t{ ! RichText.isEmpty( caption ) && <RichText.Content tagName=\"figcaption\" value={ caption } /> }\n\t\t\t\t\t</figure>\n\t\t\t\t);\n\t\t\t},\n\t\t},\n\t\t{\n\t\t\tattributes: blockAttributes,\n\t\t\tsave( { attributes } ) {\n\t\t\t\tconst { url, alt, caption, align, href, width, height } = attributes;\n\t\t\t\tconst extraImageProps = width || height ? { width, height } : {};\n\t\t\t\tconst image = <img src={ url } alt={ alt } { ...extraImageProps } />;\n\n\t\t\t\tlet figureStyle = {};\n\n\t\t\t\tif ( width ) {\n\t\t\t\t\tfigureStyle = { width };\n\t\t\t\t} else if ( align === 'left' || align === 'right' ) {\n\t\t\t\t\tfigureStyle = { maxWidth: '50%' };\n\t\t\t\t}\n\n\t\t\t\treturn (\n\t\t\t\t\t<figure className={ align ? `align${ align }` : null } style={ figureStyle }>\n\t\t\t\t\t\t{ href ? <a href={ href }>{ image }</a> : image }\n\t\t\t\t\t\t{ ! RichText.isEmpty( caption ) && <RichText.Content tagName=\"figcaption\" value={ caption } /> }\n\t\t\t\t\t</figure>\n\t\t\t\t);\n\t\t\t},\n\t\t},\n\t],\n};\n"]}